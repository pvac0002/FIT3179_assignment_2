{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Total Domestic Aircraft Trips by Destination City (All Years Combined since 1984)",
  "data": {
    "url": "https://raw.githubusercontent.com/pvac0002/FIT3179_assignment_2/refs/heads/main/flight_pairs.csv"
  },
  "transform": [
    {"aggregate": [
        {"op": "sum", "field": "Aircraft Trips", "as": "Total Aircraft Trips"}],
      "groupby": ["City2"]},
    {
      "window": [{"op": "rank", "as": "rank"}],
      "sort": [{"field": "Total Aircraft Trips", "order": "descending"}]},
    {
      "calculate": "datum.rank <= 8? datum.City2 : 'Other'",
      "as": "City" },
    {
      "aggregate": [
        {"op": "sum", "field": "Total Aircraft Trips", "as": "Total Aircraft Trips"}],
      "groupby": ["City"]}],
  "mark": {"type": "arc", "outerRadius": 160},
  "encoding": {"theta": {"field": "Total Aircraft Trips","type": "quantitative", "title": "Total Aircraft Trips"},
    "color": {"field": "City", "type": "nominal", "title": "Destination City"},
    "tooltip": [
      {"field": "City", "type": "nominal", "title": "Destination City"},
      {"field": "Total Aircraft Trips", "type": "quantitative", "title": "Total Trips"}
    ]
  }
}